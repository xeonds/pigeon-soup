# 基础语法

## HelloWorld

```c
#include <stdio.h>  
  
int main(void) {  
  printf("Hello World\n");  
  return 0;  
}
```

## 语句

程序执行的一个操作命令。**以分号结尾**。单独分号是空语句。

**表达式**（expression）是一个计算式，用来获取值。特征是由若干运算符（加减乘除）连接。

**语句块**由多个语句使用一对大括号`{}`组成。例如

```c
{  
  int x;  
  x = 1;  
}
```

**注释**有两种。

```c
/* 注释 */  
  
/*  
  这是一行注释  
*/
```

## I/O

仅介绍stdin/stdout内容。文件输入输出就算了

`printf()`和`scanf()`是在标准库的头文件`stdio.h`定义的。使用这两个函数之前，必须在源码文件头部引入这个头文件。

### printf()

`printf()`的作用是将参数文本输出到屏幕。它名字里面的`f`代表`format`（格式化），表示可以定制输出文本的格式。

```c
printf("Hello World");
```

`printf()`不会在行尾自动添加换行符，运行结束后，光标就停留在输出结束的地方，不会自动换行。为了让光标移到下一行的开头，可以在输出文本的结尾，添加一个换行符`\n`。

#### 占位符

`printf()`可以在输出文本中指定占位符。所谓“占位符”，就是这个位置可以用其他值代入。

```c
// 输出 There are 3 apples  
printf("There are %i apples\n", 3);  
```

上面示例中，`There are %i apples\n`是输出文本，里面的`%i`就是占位符，表示这个位置要用其他值来替换。占位符的第一个字符一律为百分号`%`，第二个字符表示占位符的类型，`%i`表示这里代入的值必须是一个整数。

`printf()`的第二个参数就是替换占位符的值，上面的例子是整数`3`替换`%i`。执行后的输出结果就是`There are 3 apples`。

常用的占位符除了`%i`，还有`%s`表示代入的是字符串。

```c
printf("%s will come tonight\n", "Jane");  
```

上面示例中，`%s`表示代入的是一个字符串，所以`printf()`的第二个参数就必须是字符串，这个例子是`Jane`。执行后的输出就是`Jane will come tonight`。

输出文本里面可以使用多个占位符。

```c
printf("%s says it is %i o'clock\n", "Ben", 21);  
```

上面示例中，输出文本`%s says it is %i o'clock`有两个占位符，第一个是字符串占位符`%s`，第二个是整数占位符`%i`，分别对应`printf()`的第二个参数（`Ben`）和第三个参数（`21`）。执行后的输出就是`Ben says it is 21 o'clock`。

`printf()`参数与占位符是一一对应关系，如果有`n`个占位符，`printf()`的参数就应该有`n + 1`个。如果参数个数少于对应的占位符，`printf()`可能会输出内存中的任意值。

`printf()`的占位符有许多种类，与 C 语言的数据类型相对应。下面按照字母顺序，列出常用的占位符，方便查找，具体含义在后面章节介绍。

-   `%a`：浮点数。
-   `%A`：浮点数。
-   `%c`：字符。
-   `%d`：十进制整数。
-   `%e`：使用科学计数法的浮点数，指数部分的`e`为小写。
-   `%E`：使用科学计数法的浮点数，指数部分的`E`为大写。
-   `%i`：整数，基本等同于`%d`。
-   `%f`：小数（包含`float`类型和`double`类型）。
-   `%g`：6个有效数字的浮点数。整数部分一旦超过6位，就会自动转为科学计数法，指数部分的`e`为小写。
-   `%G`：等同于`%g`，唯一的区别是指数部分的`E`为大写。
-   `%hd`：十进制 short int 类型。
-   `%ho`：八进制 short int 类型。
-   `%hx`：十六进制 short int 类型。
-   `%hu`：unsigned short int 类型。
-   `%ld`：十进制 long int 类型。
-   `%lo`：八进制 long int 类型。
-   `%lx`：十六进制 long int 类型。
-   `%lu`：unsigned long int 类型。
-   `%lld`：十进制 long long int 类型。
-   `%llo`：八进制 long long int 类型。
-   `%llx`：十六进制 long long int 类型。
-   `%llu`：unsigned long long int 类型。
-   `%Le`：科学计数法表示的 long double 类型浮点数。
-   `%Lf`：long double 类型浮点数。
-   `%n`：已输出的字符串数量。该占位符本身不输出，只将值存储在指定变量之中。
-   `%o`：八进制整数。
-   `%p`：指针。
-   `%s`：字符串。
-   `%u`：无符号整数（unsigned int）。
-   `%x`：十六进制整数。
-   `%zd`：`size_t`类型。
-   `%%`：输出一个百分号。

#### 输出格式

`printf()`可以定制占位符的输出格式。

1. 限定宽度

`printf()`允许限定占位符的最小宽度。

```c
printf("%5d\n", 123); // 输出为 "  123"  
```

上面示例中，`%5d`表示这个占位符的宽度至少为5位。如果不满5位，对应的值的前面会添加空格。

输出的值默认是右对齐，即输出内容前面会有空格；如果希望改成左对齐，在输出内容后面添加空格，可以在占位符的`%`的后面插入一个`-`号。

```c
printf("%-5d\n", 123); // 输出为 "123  "  
```

上面示例中，输出内容`123`的后面添加了空格。

对于小数，这个限定符会限制所有数字的最小显示宽度。

```c
// 输出 "  123.450000"  
printf("%12f\n", 123.45);  
```

上面示例中，`%12f`表示输出的浮点数最少要占据12位。由于小数的默认显示精度是小数点后6位，所以`123.45`输出结果的头部会添加2个空格。

2. 总是显示正负号

默认情况下，`printf()`不对正数显示`+`号，只对负数显示`-`号。如果想让正数也输出`+`号，可以在占位符的`%`后面加一个`+`。

```c
printf("%+d\n", 12); // 输出 +12  
printf("%+d\n", -12); // 输出 -12  
```

上面示例中，`%+d`可以确保输出的数值，总是带有正负号。

3. 限定小数位数

输出小数时，有时希望限定小数的位数。举例来说，希望小数点后面只保留两位，占位符可以写成`%.2f`。

```c
// 输出 Number is 0.50  
printf("Number is %.2f\n", 0.5);  
```

上面示例中，如果希望小数点后面输出3位（`0.500`），占位符就要写成`%.3f`。

这种写法可以与限定宽度占位符，结合使用。

```c
// 输出为 "  0.50"  
printf("%6.2f\n", 0.5);  
```

上面示例中，`%6.2f`表示输出字符串最小宽度为6，小数位数为2。所以，输出字符串的头部有两个空格。

最小宽度和小数位数这两个限定值，都可以用`*`代替，通过`printf()`的参数传入。

```c
printf("%*.*f\n", 6, 2, 0.5);  
// 等同于  
printf("%6.2f\n", 0.5);  
```

上面示例中，`%*.*f`的两个星号通过`printf()`的两个参数`6`和`2`传入。

4. 输出部分字符串

`%s`占位符用来输出字符串，默认是全部输出。如果只想输出开头的部分，可以用`%.[m]s`指定输出的长度，其中`[m]`代表一个数字，表示所要输出的长度。

```c
// 输出 hello  
printf("%.5s\n", "hello world");  
```

上面示例中，占位符`%.5s`表示只输出字符串“hello world”的前5个字符，即“hello”。

### scanf()

## 变量

变量（variable）可以理解成一块内存区域的名字。通过变量名，可以引用这块内存区域，获取里面存储的值。由于值可能发生变化，所以称为变量，否则就是常量了。

### 变量名

变量名在 C 语言里面属于标识符（identifier），命名有严格的规范。

-   只能由字母（包括大写和小写）、数字和下划线（`_`）组成。
-   不能以数字开头。
-   长度不能超过63个字符。

下面是一些无效变量名的例子。

```c
$zj  
j**p  
2cat  
Hot-tab  
tax rate  
don't  
```

上面示例中，每一行的变量名都是无效的。

变量名区分大小写，`star`、`Star`、`STAR`都是不同的变量。

并非所有的词都能用作变量名，有些词在 C 语言里面有特殊含义（比如`int`），另一些词是命令（比如`continue`），它们都称为关键字，不能用作变量名。另外，C 语言还保留了一些词，供未来使用，这些保留字也不能用作变量名。下面就是 C 语言主要的关键字和保留字。

> auto, break, case, char, const, continue, default, do, double, else, enum, extern, float, for, goto, if, inline, int, long, register, restrict, return, short, signed, sizeof, static, struct, switch, typedef, union, unsigned, void, volatile, while

另外，两个下划线开头的变量名，以及一个下划线 + 大写英文字母开头的变量名，都是系统保留的，自己不应该起这样的变量名。

### 变量的声明

C 语言的变量，必须先声明后使用。如果一个变量没有声明，就直接使用，会报错。

每个变量都有自己的类型（type）。声明变量时，必须把变量的类型告诉编译器。

```c
int height;  
```

上面代码声明了变量`height`，并且指定类型为`int`（整数）。

如果几个变量具有相同类型，可以在同一行声明。

```c
int height, width;  
// 等同于  
int height;  
int width;  
```

注意，声明变量的语句必须以分号结尾。

一旦声明，变量的类型就不能在运行时修改。

### 变量的赋值

C 语言会在变量声明时，就为它分配内存空间，但是不会清除内存里面原来的值。这导致声明变量以后，变量会是一个随机的值。所以，变量一定要赋值以后才能使用。

赋值操作通过赋值运算符（`=`）完成。

```c
int num;  
num = 42;  
```

上面示例中，第一行声明了一个整数变量`num`，第二行给这个变量赋值。

变量的值应该与类型一致，不应该赋予不是同一个类型的值，比如`num`的类型是整数，就不应该赋值为小数。虽然 C 语言会自动转换类型，但是应该避免赋值运算符两侧的类型不一致。

变量的声明和赋值，也可以写在一行。

```c
int num = 42;  
```

多个相同类型变量的赋值，可以写在同一行。

```c
int x = 1, y = 2;  
```

注意，赋值表达式有返回值，等于等号右边的值。

```c
int x, y;  
  
x = 1;  
y = (x = 2 * x);  
```

上面代码中，变量`y`的值就是赋值表达式（`x = 2 * x`）的返回值`2`。

由于赋值表达式有返回值，所以 C 语言可以写出多重赋值表达式。

```c
int x, y, z, m, n;  
  
x = y = z = m = n = 3;  
```

上面的代码是合法代码，一次为多个变量赋值。赋值运算符是从右到左执行，所以先为`n`赋值，然后依次为`m`、`z`、`y`和`x`赋值。

C 语言有左值（left value）和右值（right value）的概念。左值是可以放在赋值运算符左边的值，一般是变量；右值是可以放在赋值运算符右边的值，一般是一个具体的值。这是为了强调有些值不能放在赋值运算符的左边，比如`x = 1`是合法的表达式，但是`1 = x`就会报错。

### 变量的作用域

作用域（scope）指的是变量生效的范围。C 语言的变量作用域主要有两种：文件作用域（file scope）和块作用域（block scope）。

文件作用域（file scope）指的是，在源码文件顶层声明的变量，从声明的位置到文件结束都有效。

```c
int x = 1;  
  
int main(void) {  
  printf("%i\n", x);  
}  
```

上面示例中，变量`x`是在文件顶层声明的，从声明位置开始的整个当前文件都是它的作用域，可以在这个范围的任何地方读取这个变量，比如函数`main()`内部就可以读取这个变量。

块作用域（block scope）指的是由大括号（`{}`）组成的代码块，它形成一个单独的作用域。凡是在块作用域里面声明的变量，只在当前代码块有效，代码块外部不可见。

```c
int a = 12;  
  
if (a == 12) {  
  int b = 99;  
  printf("%d %d\n", a, b);  // 12 99  
}  
  
printf("%d\n", a);  // 12  
printf("%d\n", b);  // 出错  
```

上面例子中，变量`b`是在`if`代码块里面声明的，所以对于大括号外面的代码，这个变量是不存在的。

代码块可以嵌套，即代码块内部还有代码块，这时就形成了多层的块作用域。它的规则是：内层代码块可以使用外层声明的变量，但外层不可以使用内层声明的变量。如果内层的变量与外层同名，那么会在当前作用域覆盖外层变量。

```c
{  
  int i = 10;  
  
  {  
    int i = 20;  
    printf("%d\n", i);  // 20  
  }  
  
  printf("%d\n", i);  // 10  
}  
```

上面示例中，内层和外层都有一个变量`i`，每个作用域都会优先使用当前作用域声明的`i`。

最常见的块作用域就是函数，函数内部声明的变量，对于函数外部是不可见的。`for`循环也是一个块作用域，循环变量只对循环体内部可见，外部是不可见的。

```c
for (int i = 0; i < 10; i++)  
  printf("%d\n", i);  
  
printf("%d\n", i); // 出错  
```

上面示例中，`for`循环省略了大括号，但依然是一个块作用域，在外部读取循环变量`i`，编译器就会报错。